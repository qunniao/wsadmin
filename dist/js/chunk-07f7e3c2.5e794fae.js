(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-07f7e3c2"],{"0131":function(t,e,a){"use strict";var s=a("0c18"),o=a.n(s);o.a},"0c18":function(t,e,a){},"0d02":function(t,e,a){},"1deb":function(t,e,a){},"207d":function(t,e,a){"use strict";var s=a("0d02"),o=a.n(s);o.a},33290:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mod-prod-info"},[a("el-form",{ref:"dataForm",attrs:{model:t.dataForm,rules:t.rules,"label-width":"150px"}},[a("el-form-item",{attrs:{label:"商品名称:",prop:"productName",rules:[{required:!0,message:"商品名称不能为空"}]}},[a("el-col",{attrs:{span:8}},[a("el-input",{attrs:{placeholder:"请输入",maxlength:"50"},model:{value:t.dataForm.productName,callback:function(e){t.$set(t.dataForm,"productName",e)},expression:"dataForm.productName"}})],1)],1),a("el-form-item",{attrs:{label:"商品主图:",prop:"picfile"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"http://admin.zhanchengwlkj.com:8080/derivative_system_backstage/file/addFile","show-file-list":!1,"auto-upload":!0,name:"files","on-success":t.uploadImg,"before-upload":t.beforeAvatarUpload}},[t.dataForm.cover?a("img",{staticClass:"avatar",attrs:{src:t.dataForm.cover}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-form-item",{attrs:{label:"商品图片:"}},[a("el-upload",{attrs:{action:"http://admin.zhanchengwlkj.com:8080/derivative_system_backstage/file/addFile","list-type":"picture-card",name:"files","file-list":t.dataForm.productImageDtos,"auto-upload":!0,"on-success":t.uploadImgTwo,"on-preview":t.handlePictureCardPreview,"on-remove":t.handleRemove}},[a("i",{staticClass:"el-icon-plus"})]),a("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1),a("el-form-item",{attrs:{label:"商品货号:",prop:"productNumber",rules:[{required:!0,message:"商品货号不能为空"}]}},[a("el-col",{attrs:{span:8}},[a("el-input",{attrs:{placeholder:"请输入",maxlength:"50"},model:{value:t.dataForm.productNumber,callback:function(e){t.$set(t.dataForm,"productNumber",e)},expression:"dataForm.productNumber"}})],1)],1),a("el-form-item",{attrs:{label:"商品零售价:",prop:"price",rules:[{required:!0,message:"商品零售价不能为空"}]}},[a("el-col",{attrs:{span:8}},[a("el-input",{attrs:{placeholder:"请输入",maxlength:"50"},model:{value:t.dataForm.price,callback:function(e){t.$set(t.dataForm,"price",e)},expression:"dataForm.price"}})],1)],1),a("el-form-item",{attrs:{label:"商品市场价:",prop:"marketPrice"}},[a("el-col",{attrs:{span:8}},[a("el-input",{attrs:{placeholder:"请输入",maxlength:"50"},model:{value:t.dataForm.marketPrice,callback:function(e){t.$set(t.dataForm,"marketPrice",e)},expression:"dataForm.marketPrice"}})],1)],1),a("el-form-item",{attrs:{label:"进货价:",prop:"stockPrice",rules:[{required:!0,message:"商品进货价格不能为空"}]}},[a("el-col",{attrs:{span:8}},[a("el-input",{attrs:{placeholder:"请输入",maxlength:"50"},model:{value:t.dataForm.stockPrice,callback:function(e){t.$set(t.dataForm,"stockPrice",e)},expression:"dataForm.stockPrice"}})],1)],1),a("el-form-item",{attrs:{label:"邀请奖励金额:",prop:"inviteReward"}},[a("el-col",{attrs:{span:8}},[a("el-input",{attrs:{placeholder:"请输入",maxlength:"50"},model:{value:t.dataForm.inviteReward,callback:function(e){t.$set(t.dataForm,"inviteReward",e)},expression:"dataForm.inviteReward"}})],1)],1),a("el-form-item",{attrs:{label:"装箱数:",prop:"weight",rules:[{required:!0,message:"装箱数不能为空"}]}},[a("el-col",{attrs:{span:8}},[a("el-input",{attrs:{placeholder:"请输入",maxlength:"50"},model:{value:t.dataForm.weight,callback:function(e){t.$set(t.dataForm,"weight",e)},expression:"dataForm.weight"}})],1)],1),a("el-form-item",{attrs:{label:"（必选）商品分类:"}},[a("el-col",{attrs:{span:8}},[a("el-button",{attrs:{type:"primary"},on:{click:t.handleSecondDepShow}},[t._v("选择分类")])],1)],1),a("el-form-item",t._l(t.shoptypelist,function(e){return a("el-tag",{key:e.tid,attrs:{closable:""},on:{close:function(a){t.delshoptype(e.tid)}}},[t._v("\n          "+t._s(e.typeName)+"\n        ")])})),a("el-form-item",{attrs:{label:"商品属性组:"}},[a("el-col",{attrs:{span:8}},[a("el-button",{attrs:{type:"primary"},on:{click:t.handleAttributeDepShow}},[t._v("选择属性组")])],1)],1),a("el-form-item",[a("el-col",{attrs:{span:8}},[a("el-input",{attrs:{placeholder:"请输入",maxlength:"50"},model:{value:t.attrtext,callback:function(e){t.attrtext=e},expression:"attrtext"}})],1),a("el-button",{on:{click:t.saveattrtext}},[t._v("添加")])],1),t._l(t.attributeDepList,function(e,s){return a("el-form-item",{key:s,attrs:{label:e.name,rules:{required:!0,message:"属性值不能为空",trigger:"blur"}}},[a("el-col",{attrs:{span:8}},[a("el-input",{model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"domain.value"}})],1),a("el-button",{on:{click:function(a){a.preventDefault(),t.removeDomain(e)}}},[t._v("删除")])],1)}),a("el-collapse",{on:{change:t.handleChange}},[a("el-collapse-item",{attrs:{title:"更多设置",name:"1"}},[a("el-form-item",{attrs:{label:"下单时是否显示库存:"}},[a("el-radio-group",{model:{value:t.dataForm.showStock,callback:function(e){t.$set(t.dataForm,"showStock",e)},expression:"dataForm.showStock"}},[a("el-radio",{attrs:{label:1}},[t._v("是")]),a("el-radio",{attrs:{label:0}},[t._v("否")])],1)],1),a("el-form-item",{attrs:{label:"商品排序:",prop:"sort"}},[a("el-col",{attrs:{span:8}},[a("el-input",{attrs:{placeholder:"请输入",maxlength:"50"},model:{value:t.dataForm.sort,callback:function(e){t.$set(t.dataForm,"sort",e)},expression:"dataForm.sort"}})],1)],1),a("el-form-item",{attrs:{label:"基础销量:",prop:"sales"}},[a("el-col",{attrs:{span:8}},[a("el-input",{attrs:{placeholder:"请输入",maxlength:"50"},model:{value:t.dataForm.sales,callback:function(e){t.$set(t.dataForm,"sales",e)},expression:"dataForm.sales"}})],1)],1),a("sku-tag",{ref:"skuTag",on:{change:t.skuTagChangeSkuHandler}}),a("sku-table",{ref:"skuTable",attrs:{prodName:t.prodName},on:{"update:prodName":function(e){t.prodName=e}},model:{value:t.skuList,callback:function(e){t.skuList=e},expression:"skuList"}})],1)],1),a("div",{staticClass:"mbline"},[t._v("运费模板")]),a("el-form-item",{attrs:{label:"配送方式"}},[a("div",[a("el-radio",{attrs:{label:"0"},model:{value:t.dataForm.isUniformFreight,callback:function(e){t.$set(t.dataForm,"isUniformFreight",e)},expression:"dataForm.isUniformFreight"}},[t._v("分别设置")]),a("el-form-item",{attrs:{"label-width":"180px",label:"零售运费模板："}},[a("el-select",{attrs:{disabled:1==t.dataForm.isUniformFreight,placeholder:"请选择"},model:{value:t.dataForm.retailFreightId,callback:function(e){t.$set(t.dataForm,"retailFreightId",e)},expression:"dataForm.retailFreightId"}},t._l(t.freightlist,function(t){return a("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}))],1),a("el-form-item",{staticStyle:{"margin-top":"10px"},attrs:{"label-width":"180px",label:"代理运费模板："}},[a("el-select",{attrs:{disabled:1==t.dataForm.isUniformFreight,placeholder:"请选择"},model:{value:t.dataForm.agentFreightId,callback:function(e){t.$set(t.dataForm,"agentFreightId",e)},expression:"dataForm.agentFreightId"}},t._l(t.freightlist,function(t){return a("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}))],1),a("el-form-item",{staticStyle:{"margin-top":"10px"},attrs:{"label-width":"180px",label:"云仓库提货运费模板："}},[a("el-select",{attrs:{disabled:1==t.dataForm.isUniformFreight,placeholder:"请选择"},model:{value:t.dataForm.cloudFreightId,callback:function(e){t.$set(t.dataForm,"cloudFreightId",e)},expression:"dataForm.cloudFreightId"}},t._l(t.freightlist,function(t){return a("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}))],1)],1),a("div",[a("el-radio",{attrs:{label:"1"},model:{value:t.dataForm.isUniformFreight,callback:function(e){t.$set(t.dataForm,"isUniformFreight",e)},expression:"dataForm.isUniformFreight"}},[t._v("统一设置")]),a("el-form-item",{attrs:{"label-width":"180px",label:"设置："}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.allfreight,callback:function(e){t.allfreight=e},expression:"allfreight"}},t._l(t.freightlist,function(t){return a("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}))],1)],1)]),a("div",{staticClass:"mbline"},[t._v("上下架/其他")]),a("el-form-item",{attrs:{"label-width":"180px",label:"代理方式：",prop:"checkList"}},[a("el-checkbox-group",{model:{value:t.dataForm.checkList,callback:function(e){t.$set(t.dataForm,"checkList",e)},expression:"dataForm.checkList"}},[a("el-checkbox",{attrs:{label:"物流进货"}}),a("el-checkbox",{attrs:{label:"云仓库储货"}})],1)],1),a("el-form-item",{attrs:{"label-width":"180px",label:"上架时间"}},[a("el-radio",{attrs:{label:"1"},model:{value:t.shopup,callback:function(e){t.shopup=e},expression:"shopup"}},[t._v("立即上架")]),a("el-radio",{attrs:{label:"2"},model:{value:t.shopup,callback:function(e){t.shopup=e},expression:"shopup"}},[t._v("定时上架")]),a("el-radio",{attrs:{label:"3"},model:{value:t.shopup,callback:function(e){t.shopup=e},expression:"shopup"}},[t._v("暂不上架")]),2==t.shopup?a("el-form-item",[a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间"},model:{value:t.dataForm.putawayTime,callback:function(e){t.$set(t.dataForm,"putawayTime",e)},expression:"dataForm.putawayTime"}})],1):t._e()],1),3!=t.shopup?a("el-form-item",{attrs:{"label-width":"180px",label:"定时下架"}},[a("el-radio",{attrs:{label:"1"},model:{value:t.shopdown,callback:function(e){t.shopdown=e},expression:"shopdown"}},[t._v("是")]),a("el-radio",{attrs:{label:"2"},model:{value:t.shopdown,callback:function(e){t.shopdown=e},expression:"shopdown"}},[t._v("否")]),1==t.shopdown?a("el-form-item",[a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间"},model:{value:t.dataForm.soldoutTime,callback:function(e){t.$set(t.dataForm,"soldoutTime",e)},expression:"dataForm.soldoutTime"}})],1):t._e()],1):t._e(),a("el-form-item",{attrs:{label:"商品详情："}},[a("div",{staticStyle:{"text-align":"left"},attrs:{id:"editorElem"}})]),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dataFormSubmit()}}},[t._v("确定")])],1),a("el-dialog",{attrs:{title:"商品分类","append-to-body":!0,visible:t.secondDepShow,width:"60%"},on:{"update:visible":function(e){t.secondDepShow=e}}},[t.secondDepShow?a("second-index",{attrs:{"prodtype-list":t.shoptypelist},on:{changetype:t.changeshoptype,"close-form":function(e){t.secondDepShow=!1}}}):t._e()],1),a("el-dialog",{attrs:{title:"商品属性组","append-to-body":!0,visible:t.AttributeDepShow,width:"60%"},on:{"update:visible":function(e){t.AttributeDepShow=e}}},[t.AttributeDepShow?a("attribute-index",{on:{changeattrlist:t.changeattrlist,"close-form":function(e){t.AttributeDepShow=!1}}}):t._e()],1)],2)],1)},o=[],i=(a("ac6a"),a("55dd"),a("28a5"),a("7f7f"),a("a27a")),r=a("bc3a"),l=a.n(r),n=(a("ed08"),a("1a0b")),u=a.n(n),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mod-prod-sku-table"},[a("el-form-item",[a("el-table",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:t.value,border:"","span-method":t.tableSpanMethod}},[t._l(t.tableLeftTitles,function(e,s){return a("el-table-column",{key:s,attrs:{label:e},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.properties.split(";")[s].split(":")[1])+"\n        ")]}}])})}),a("el-table-column",{attrs:{prop:"productNumber",label:"规格货号"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{type:"number",disabled:!e.row.status},model:{value:e.row.productNumber,callback:function(a){t.$set(e.row,"productNumber",a)},expression:"scope.row.productNumber"}})]}}])}),a("el-table-column",{attrs:{prop:"price",label:"价格"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{type:"number",disabled:!e.row.status},model:{value:e.row.price,callback:function(a){t.$set(e.row,"price",a)},expression:"scope.row.price"}})]}}])}),a("el-table-column",{attrs:{prop:"weight",label:"重量"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{type:"number",disabled:!e.row.status},model:{value:e.row.weight,callback:function(a){t.$set(e.row,"weight",a)},expression:"scope.row.weight"}})]}}])}),t.tableLeftTitles.length?a("el-table-column",{attrs:{prop:"pic",label:"sku图片",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-upload",{staticClass:"pic-uploader-component",attrs:{action:"http://admin.zhanchengwlkj.com:8080/derivative_system_backstage/file/addFile","show-file-list":!1,name:"files","on-success":function(a){return t.changeSkuCover(""+e.$index,a)},"before-upload":t.beforeAvatarUpload}},[e.row.pic?a("img",{staticClass:"pic",attrs:{src:e.row.pic}}):a("i",{staticClass:"el-icon-plus pic-uploader-icon"})])]}}])}):t._e()],2)],1)],1)},p=[],d=(a("f751"),a("cadf"),a("551c"),a("097d"),{data:function(){return{dbSpecs:[],dbSpecValues:[],specs:[],initing:!1}},components:{},props:{value:{default:[],type:Array}},watch:{},created:function(){},computed:{tableLeftTitles:function(){for(var t=[],e=0;e<this.skuTags.length;e++){var a=this.skuTags[e];t.push(a.tagName)}return t},skuTags:{get:function(){return this.$store.state.prod.skuTags}},defalutSku:function(){return this.$store.state.prod.defalutSku}},methods:{init:function(){this.initing=!0},beforeAvatarUpload:function(t){var e="image/jpeg"===t.type||"image/png"===t.type,a=t.size/1024/1024<2;return e||this.$message.error("上传头像图片只能是 JPG或者PNG 格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),e&&a},getTableSpecData:function(){return this.value},tableSpanMethod:function(t){t.row,t.column,t.rowIndex,t.columnIndex},changeSkuCover:function(t,e){console.log(e),console.log(t),this.value[t].pic=e.data},changeSkuStatus:function(t){this.value[t].status=this.value[t].status?0:1},skuAddProdName:function(){if(!this.initing){for(var t=[],e=0;e<this.value.length;e++){var a=Object.assign({},this.value[e]);if(!a.properties)return;a.skuName="";var s=a.properties.split(";");for(var o in s)a.skuName+=s[o].split(":")[1]+" ";t.push(a)}this.$emit("input",t)}}}}),m=d,h=(a("207d"),a("2877")),g=Object(h["a"])(m,c,p,!1,null,null,null);g.options.__file="sku-table.vue";var f=g.exports,v=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mod-prod-sku-tag"},[a("el-form-item",{attrs:{label:"商品规格"}},[a("el-button",{attrs:{size:"mini"},on:{click:function(e){t.shopTagInput()}}},[t._v("添加规格")]),t._l(t.skuTags,function(e,s){return a("div",{key:s},[a("span",[t._v(t._s(e.tagName))]),a("el-button",{staticClass:"button-new-tag",attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(e){t.removeTag(s)}}},[t._v("删除")]),a("br"),t._l(e.tagItems,function(e,o){return a("el-tag",{key:e,attrs:{closable:"","disable-transitions":!1},on:{close:function(e){t.handleTagClose(s,o)}}},[t._v("\n        "+t._s(e)+"\n      ")])}),t.tagItemInputs[s]&&t.tagItemInputs[s].visible?a("el-input",{ref:"saveTagInput"+s,refInFor:!0,staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:function(e){t.handleInputConfirm(s)}},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.handleInputConfirm(s)}},model:{value:t.tagItemInputs[s].value,callback:function(e){t.$set(t.tagItemInputs[s],"value",e)},expression:"tagItemInputs[tagIndex].value"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:function(e){t.showTagInput(s)}}},[t._v("+ 添加")])],2)})],2),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.isShowTagInput,expression:"isShowTagInput"}],attrs:{label:"规格名"}},[a("el-col",{attrs:{span:8}},[a("el-select",{attrs:{filterable:"","allow-create":"","default-first-option":"",placeholder:"请选择"},on:{change:t.handleTagClick},model:{value:t.addTagInput.propName,callback:function(e){t.$set(t.addTagInput,"propName",e)},expression:"addTagInput.propName"}},t._l(t.unUseTags,function(t){return a("el-option",{key:t.propId,attrs:{label:t.propName,value:t.propName}})}))],1)],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.isShowTagInput,expression:"isShowTagInput"}],attrs:{label:"规格值"}},[a("el-col",{attrs:{span:8}},[a("el-select",{attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"请选择"},model:{value:t.addTagInput.selectValues,callback:function(e){t.$set(t.addTagInput,"selectValues",e)},expression:"addTagInput.selectValues"}},t._l(t.dbTagValues,function(t){return a("el-option",{key:t.valueId,attrs:{label:t.propValue,value:t.propValue}})}))],1)],1),a("el-form-item",[a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.isShowTagInput,expression:"isShowTagInput"}],attrs:{size:"mini",type:"primary"},on:{click:function(e){t.addTag()}}},[t._v("确定")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.isShowTagInput,expression:"isShowTagInput"}],attrs:{size:"mini"},on:{click:function(e){t.hideTagInput()}}},[t._v("取消")])],1)],1)},b=[],k=(a("20d6"),{data:function(){return{value:[],isShowTagInput:!1,addTagInput:{propName:"",selectValues:[]},tagItemInputs:[],dbTags:[],dbTagValues:[],specs:[],initing:!1}},created:function(){},computed:{unUseTags:function(){for(var t=this,e=[],a=function(a){var s=t.dbTags[a],o=t.skuTags.findIndex(function(t){return t.tagName===s.propName});-1===o&&e.push(s)},s=0;s<this.dbTags.length;s++)a(s);return e},skuTags:{get:function(){return this.$store.state.prod.skuTags},set:function(t){this.$store.commit("prod/updateSkuTags",t)}},defalutSku:function(){return this.$store.state.prod.defalutSku}},watch:{skuTags:{handler:function(t,e){var a=this;if(this.initing)this.initing=!1;else{var s=[],o=[];t.forEach(function(t){0===s.length?t.tagItems.forEach(function(e){var o=Object.assign({},a.defalutSku);o.properties="".concat(t.tagName,":").concat(e),s.push(o)}):(o=[],t.tagItems.forEach(function(e){s.forEach(function(a){var s=Object.assign({},a);s.properties="".concat(a.properties,";").concat(t.tagName,":").concat(e),o.push(s)})}),s=o)}),s.length||s.push(Object.assign({},this.defalutSku)),this.$emit("change",s)}},deep:!0}},methods:{init:function(t){var e=this;if(this.value=t,t&&t.length){this.initing=!0;for(var a=[],s=0;s<t.length;s++){var o=t[s];if(!o.properties)break;var i=o.properties.split(";"),r=function(t){var s=i[t].split(":");a[t]||(a[t]={tagName:s[0],tagItems:[]},e.tagItemInputs.push({visible:!1,value:""}));var o=a[t].tagItems.findIndex(function(t){return t===s[1]});-1===o&&a[t].tagItems.push(s[1])};for(var l in i)r(l)}this.skuTags=a}else this.$emit("change",[Object.assign({},this.defalutSku)])},shopTagInput:function(){console.log(this.skuTags),this.skuTags.length>=2?alert("最多两个"):this.isShowTagInput=!0},hideTagInput:function(){this.isShowTagInput=!1,this.cleanTagInput()},addTag:function(){var t=this.addTagInput.selectValues;if(this.addTagInput.propName)if(t.length){this.isShowTagInput=!1;for(var e=[],a=0;a<t.length;a++){var s=t[a];e.push(s)}this.$store.commit("prod/addSkuTag",{tagName:this.addTagInput.propName,tagItems:e}),this.cleanTagInput()}else this.$message.error("请输入规格值");else this.$message.error("请输入规格名")},cleanTagInput:function(){this.addTagInput={propName:"",selectValues:[]}},handleTagClick:function(){var t=this;this.dbTagValues=[],this.addTagInput.selectValues=[];this.dbTags.findIndex(function(e){return e.propName===t.addTagInput.propName})},handleTagClose:function(t,e){1!==this.skuTags[t].tagItems.length&&this.$store.commit("prod/removeSkuTagItem",{tagIndex:t,tagItemIndex:e})},handleInputConfirm:function(t){var e=this.tagItemInputs[t].value;e&&this.$store.commit("prod/addSkuTagItem",{tagIndex:t,tagItem:e}),this.tagItemInputs[t].visible=!1,this.tagItemInputs[t].value=""},showTagInput:function(t){var e=this;this.tagItemInputs.push({visible:!1,value:""}),this.tagItemInputs[t].visible=!0,this.$nextTick(function(){e.$refs["saveTagInput".concat(t)][0].$refs.input.focus()})},removeTag:function(t){this.$store.commit("prod/removeSkuTag",t)}}}),w=k,I=(a("0131"),Object(h["a"])(w,v,b,!1,null,null,null));I.options.__file="sku-tag.vue";var F=I.exports,y=function(){return a.e("chunk-32d2ee24").then(a.bind(null,"d5d9"))},T=function(){return a.e("chunk-1fa10294").then(a.bind(null,"e7ad"))},x={name:"editor",data:function(){return{transportId:null,shopid:0,shopup:"1",shopdown:"1",value1:"",attrtext:"",attributeDepList:[],category:{list:[],selected:[],props:{value:"categoryId",label:"categoryName"}},rules:{checkList:[{type:"array",required:!0,message:"请选择代理购买方式",trigger:"change"}],picfile:[{required:!0,message:"请上传图片"}]},fileList:[],freightlist:[],allfreight:"",AttributeDepShow:!1,secondDepShow:!1,imageShowUrl:"",shoptypelist:[],skuList:[],prodName:"",dialogImageUrl:"",dialogVisible:!1,dataForm:{checkList:[],productType:0,sid:0,productNumber:"",productName:"",cover:"",productIntro:"",price:"",inviteReward:"",marketPrice:"",weight:"",stockPrice:"",isUniformFreight:"0",showStock:1,content:"",retailFreightId:"",agentFreightId:"",cloudFreightId:"",sales:"",agentBuy:"",sort:"",putawayTime:"",soldoutTime:"",typeIds:[],productParams:[],units:[],standardDtos:[],productImageDtos:[]},tags:[]}},components:{SkuTable:f,SkuTag:F,SecondIndex:T,AttributeIndex:y},props:{depId:{required:!0}},computed:{defalutSku:function(){return this.$store.state.prod.defalutSku}},activated:function(){this.dataForm.prodId=this.$route.query.prodId,this.getDataList()},methods:{getDataList:function(){},handleRemove:function(t,e){for(var a=0;a<this.dataForm.productImageDtos.length;a++)t.url==this.dataForm.productImageDtos[a].url&&this.dataForm.productImageDtos.splice(a,1)},uploadImgTwo:function(t){this.dataForm.productImageDtos.push({sort:0,url:t.data})},handlePictureCardPreview:function(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},removeDomain:function(t){for(var e=0;e<this.attributeDepList.length;e++)this.attributeDepList[e].name==t.name&&this.attributeDepList.splice(e,1)},delshoptype:function(t){for(var e=0;e<this.shoptypelist.length;e++)this.shoptypelist[e].tid==t&&this.shoptypelist.splice(e,1)},saveattrtext:function(){for(var t=!0,e=0;e<this.attributeDepList.length;e++)this.attributeDepList[e].name==this.attrtext&&(t=!1,this.$message({type:"error",message:"不能添加已有属性值"}));t&&(""!=this.attrtext?(this.attributeDepList.push({name:this.attrtext,value:""}),this.attrtext=""):this.$message({type:"error",message:"属性值不能为空"}))},changeshoptype:function(t){this.shoptypelist=t},changeattrlist:function(t){for(var e=t.split(","),a=0;a<e.length;a++){for(var s=!0,o=0;o<this.attributeDepList.length;o++)this.attributeDepList[o].name==e[a]&&(s=!1);s&&this.attributeDepList.push({name:e[a],value:""})}},handleChange:function(){},handleSecondDepShow:function(){this.secondDepShow=!0},handleAttributeDepShow:function(){this.AttributeDepShow=!0},uploadImg:function(t){this.dataForm.cover=t.data,this.imageShowUrl=t.data,this.rules.picfile=[{required:!0,message:"请上传图片"}],""!=this.dataForm.cover&&(this.rules.picfile=[])},beforeAvatarUpload:function(t){var e="image/jpeg"===t.type||"image/png"===t.type,a=t.size/1024/1024<2;return e||this.$message.error("上传头像图片只能是 JPG或者PNG 格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),e&&a},getCategoryList:function(){},handleCategoryChange:function(t){this.dataForm.categoryId=t[t.length-1]},dataFormSubmit:function(){var t=this;this.$refs["dataForm"].validate(function(e){if(e){if(t.shoptypelist.length<1)return t.$message({type:"error",message:"产品分类不能为空"}),!1;var a=t.dataForm;if(0==t.dataForm.checkList.length?a.agentBuy=0:2==t.dataForm.checkList.length?a.agentBuy=3:"物流进货"==t.dataForm.checkList[0]?a.agentBuy=1:a.agentBuy=2,1==t.shopup?(a.putawayTime=0,2==t.shopdown&&(a.soldoutTime=0)):3==t.shopup?(a.putawayTime=0,a.soldoutTime=0):2==t.shopdown&&(a.soldoutTime=0),a.standardDtos=[],a.productGuigeNames=[],t.skuList.length>0){var s=t.skuList[0].properties.split(";");1==s.length?a.productGuigeNames.push({gname:s[0],lvevl:1}):a.productGuigeNames.push({gname:s[0],lvevl:1},{gname:s[1],lvevl:2})}for(var o=0;o<t.skuList.length;o++){var r={sp1:"",sp2:"",productNumber:"",price:"",weight:"",pic:""},l=t.skuList[o].properties.split(";");l.length<=1?(r.sp1=l[0].split(":")[1],r.productNumber=t.skuList[o].productNumber,r.weight=t.skuList[o].weight,r.price=t.skuList[o].price,r.pic=t.skuList[o].pic):(r.sp1=l[0].split(":")[1],r.sp2=l[1].split(":")[1],r.productNumber=t.skuList[o].productNumber,r.weight=t.skuList[o].weight,r.price=t.skuList[o].price,r.pic=t.skuList[o].pic),a.standardDtos.push(r)}a.typeIds=[];for(var n=0;n<t.shoptypelist.length;n++)a.typeIds.push(t.shoptypelist[n].tid);if(2==t.dataForm.isUniformFreight&&(a.retailFreightId=t.allfreight,a.agentFreightId=t.allfreight,a.cloudFreightId=t.allfreight),a.productType=0,0!=t.shopid){var u={pid:t.shopid,productType:0,productNumber:a.productNumber,cover:a.cover,productName:a.productName,productIntro:"",price:a.price,isUniformFreight:a.isUniformFreight,marketPrice:a.marketPrice,weight:a.weight,showStock:a.showStock,content:a.content,retailFreightId:a.retailFreightId,agentFreightId:a.agentFreightId,cloudFreightId:a.cloudFreightId,sales:a.sales,sort:a.sort,inviteReward:a.inviteReward,stockPrice:a.stockPrice,putawayTime:a.putawayTime,soldoutTime:a.soldoutTime,typeIds:a.typeIds,productParams:a.productParams,units:a.units,standardDtos:a.standardDtos,productImageDtos:a.productImageDtos};Object(i["h"])(u).then(function(e){var a=e.data;200==a.code?(t.$message({type:"success",message:"修改产品成功"}),t.$emit("close-form"),t.$emit("finish-action")):t.errorMsg(a.message)}).catch(function(e){console.log(e),t.tableLoading=!1})}else Object(i["g"])(a).then(function(e){var a=e.data;200==a.code?(t.$message({type:"success",message:"添加产品成功"}),t.$emit("close-form"),t.$emit("finish-action")):t.errorMsg(a.message)}).catch(function(e){console.log(e),t.tableLoading=!1})}})},paramSetPriceAndStocks:function(t){},skuTagChangeSkuHandler:function(t){var e=this.prodName;t.forEach(function(t){if(t.properties){t.skuName="";var a=t.properties.split(";");for(var s in a)t.skuName+=a[s].split(":")[1]+" ";t.prodName=e+" "+t.skuName}}),this.skuList=t},getproddetail:function(t){var e=this;Object(i["b"])(t).then(function(t){var a=t.data.data;e.dataForm=a,e.dataForm.productImageDtos=a.productImageList,e.rules.picfile=[{required:!0,message:"请上传图片"}],""!=e.dataForm.cover&&(e.rules.picfile=[]),(a.agentBuy=0)?e.dataForm.checkList=[]:(a.agentBuy=3)?e.dataForm.checkList=["物流进货","云仓库储货"]:(a.agentBuy=1)?e.dataForm.checkList=["物流进货"]:e.dataForm.checkList=["云仓库储货"],e.shoptypelist=a.productTypeList,e.dataForm.isUniformFreight=a.isUniformFreight,e.attributeDepList=a.productParamList;for(var s=a.productSkuList,o=a.productGuigeNameList,i=0;i<s.length;i++){var r={pic:"",price:0,prodName:" 标签值 二级标签值 ",productNumber:0,properties:"一级标签:标签值;二级标签:二级标签值",skuName:"标签值 二级标签值 ",status:1,weight:0};r.pic=s[i].pic,r.price=s[i].price,r.weight=s[i].weight,r.productNumber=s[i].productNumber,2==o.length?(r.properties=o[0].gname+":"+s[i].sp1+";"+o[1].gname+":"+s[i].sp2,r.skuName=s[i].sp1+" "+s[i].sp2,r.prodName=" "+s[i].sp1+" "+s[i].sp2+" "):(r.skuName=s[i].sp1,r.properties=o[0].gname+":"+s[i].sp1,r.skuName=s[i].sp1,r.prodName=" "+s[i].sp1),e.skuList.push(r)}-1==a.status?e.shopup="3":0==a.putawayTime?(e.shopup="1",0!=a.soldoutTime?e.shopdown="1":e.shopdown="2"):(e.shopup="2",0!=a.soldoutTime?e.shopdown="1":e.shopdown="2");var n=new u.a("#editorElem");n.customConfig.onchange=function(t){e.dataForm.content=t},n.customConfig.customUploadImg=function(t,e){var a=new FormData;a.append("files",t[0]),l.a.post("http://admin.zhanchengwlkj.com:8080/derivative_system_backstage/file/addFile",a,{headers:{"Content-Type":"multipart/form-data"}}).then(function(t){var a=t.data;e(a.data)})},n.customConfig.uploadImgShowBase64=!0,n.create(),n.txt.html(e.dataForm.content)}).catch(function(t){e.tableLoading=!1})},errorMsg:function(t){this.$message({message:t,type:"error",duration:1500})},getfreightlist:function(){var t=this,e={current:1,size:100};Object(i["f"])(e).then(function(e){var a=e.data.data.records;t.freightlist=a}).catch(function(e){t.tableLoading=!1})}},mounted:function(){var t=this;if(0!=this.depId)this.shopid=this.depId,this.getproddetail(this.depId);else{var e=new u.a("#editorElem");e.customConfig.uploadImgShowBase64=!0,e.customConfig.onchange=function(e){t.dataForm.content=e},e.customConfig.customUploadImg=function(t,e){var a=new FormData;a.append("files",t[0]),l.a.post("http://admin.zhanchengwlkj.com:8080/derivative_system_backstage/file/addFile",a,{headers:{"Content-Type":"multipart/form-data"}}).then(function(t){var a=t.data;e(a.data)})},e.customConfig.uploadImgShowBase64=!0,e.create()}this.getfreightlist()}},S=x,N=(a("9eca"),Object(h["a"])(S,s,o,!1,null,"67394c02",null));N.options.__file="prodInfo.vue";e["default"]=N.exports},"9eca":function(t,e,a){"use strict";var s=a("1deb"),o=a.n(s);o.a}}]);