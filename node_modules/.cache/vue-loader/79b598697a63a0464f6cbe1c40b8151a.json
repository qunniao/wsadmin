{"remainingRequest":"E:\\HtmlProjects\\wsadmin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\HtmlProjects\\wsadmin\\src\\components\\adminRole\\adminRoleSetPower.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\HtmlProjects\\wsadmin\\src\\components\\adminRole\\adminRoleSetPower.vue","mtime":1576992693510},{"path":"E:\\HtmlProjects\\wsadmin\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\HtmlProjects\\wsadmin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1576862582236},{"path":"E:\\HtmlProjects\\wsadmin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport actionItem from'./actionItem';\n\nimport {\n  getAdminActionListAPI,getAdminRolePowerListAPI\n} from '@/api/adminRoleApi.js'\n\nimport {\n  updateAdminRolePowerAPI\n} from '@/api/adminRoleApi.js'\n\nexport default {\n   name:'editor',\n  data () {\n    return {\n      // 规格列表\n      dataForm:{\n\n      },\n      checkList:[],\n      actionIds:[],\n      actionList:[],\n      powerList:[]\n    }\n  },\n  components: {\n        actionItem\n  },\n  props: {\n    roleId: {\n      required: true,\n    },\n  },\n \n  methods: {\n    //获取子组件的值\n    showMessageFromChild(data){\n          console.log(\"data:\"+data);\n          this.checkList = data;\n    },\n\n    dataFormSubmit () {\n      console.log(\"roleId:\"+this.roleId);\n      console.log(this.checkList);\n        this.$refs['dataForm'].validate((valid) => {\n          var ids = '';\n          for(let i=0;i<this.checkList.length;i++){\n            ids+=this.checkList[i]+\",\";\n          }\n      console.log(ids);\n          if(valid){\n            const params = {\n              roleId:this.roleId,\n              ids:ids\n            }\n           \n              updateAdminRolePowerAPI(params).then(res => {\n                    const sucresponse = res.data;\n                    if(sucresponse.code==200){\n                      this.$message({\n                        type: 'success',\n                        message: '设置成功',\n                      });\n                      this.$emit('close-form')\n                      this.$emit('finish-action')\n                    }else{\n                      this.errorMsg(sucresponse.message)\n                    }\n                })\n                .catch(err => {\n                  console.log(err)\n                   \n                })\n           \n\n            console.log(params)\n          }\n        })\n    },\n   getAdminActionList(){\n      console.log(\"getAdminActionList\");\n      const params = {\n              roleId:this.roleId\n            }\n            getAdminActionListAPI(params)\n                .then(res => {\n                  console.log(\"getAdminActionListAPI 返回\")\n                    const data = res.data.data.actionList;\n                    const powerList = res.data.data.powerList;\n                    var checkArray = [];\n                    for(var i=0;i<powerList.length;i++){\n                      checkArray.push(powerList[i].actionId);\n                    }\n                    this.checkList = checkArray;\n                    this.actionList = data;\n                  \n                    console.log(this.actionList)\n                    console.log(this.checkList)\n                })\n                .catch(err => {\n                    \n                })\n    },\n\n  \n    \n    errorMsg (message) {\n      this.$message({\n        message: message,\n        type: 'error',\n        duration: 1500\n      })\n    },\n    /*\n      * 返回上层\n      */\n    backhtmls(){\n        this.$emit('close-form')\n    }\n   \n  },\n\n   mounted() {\n      console.log(\"mounted方法\");\n      this.getAdminActionList();  \n    },  \n  \n}\n\n",null]}