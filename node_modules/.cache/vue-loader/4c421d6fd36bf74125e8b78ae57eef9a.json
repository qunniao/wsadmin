{"remainingRequest":"E:\\HtmlProjects\\wsadmin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\HtmlProjects\\wsadmin\\src\\components\\agentLevelSetUp\\agentLevelSetUpInfo.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\HtmlProjects\\wsadmin\\src\\components\\agentLevelSetUp\\agentLevelSetUpInfo.vue","mtime":1573043726499},{"path":"E:\\HtmlProjects\\wsadmin\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\HtmlProjects\\wsadmin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1576862582236},{"path":"E:\\HtmlProjects\\wsadmin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport {\r\n     timeStamp2String,\r\n} from '@/api/globalAPI.js'\r\nimport {\r\n  getAgentLevelInfoAPI,\r\n  postAgentLevelUpdateAPI\r\n}from '@/api/agentAduitAPI.js'\r\nexport default {\r\n    name:'prodList',\r\n    data(){\r\n        return{\r\n            isDiscount:'0',\r\n            agentid:'',\r\n            dataForm:{\r\n                title:'',\r\n                istask:'0',\r\n                sales:'',\r\n                typeId:1\r\n            },\r\n            timelist:[\r\n                {name:'永久',value:0},\r\n                {name:'1个月',value:1},\r\n                {name:'2个月',value:2},\r\n                {name:'3个月',value:3},\r\n                {name:'4个月',value:4},\r\n                {name:'5个月',value:5},\r\n                {name:'6个月',value:6},\r\n                {name:'7个月',value:7},\r\n                {name:'8个月',value:8},\r\n                {name:'9个月',value:9},\r\n                {name:'10个月',value:10},\r\n                {name:'11个月',value:11},\r\n                {name:'12个月',value:12},\r\n                {name:'13个月',value:13},                \r\n                {name:'14个月',value:14},\r\n                {name:'15个月',value:15},\r\n                {name:'16个月',value:16},\r\n                {name:'17个月',value:17},\r\n                {name:'18个月',value:18},\r\n                {name:'19个月',value:19},\r\n                {name:'20个月',value:20},\r\n                {name:'21个月',value:21},\r\n                {name:'22个月',value:22},\r\n                {name:'23个月',value:23},\r\n                {name:'24个月',value:24},\r\n                {name:'36个月',value:36},\r\n            ],\r\n            stock_type:1,\r\n        };\r\n    },\r\n    components:{\r\n        // AddDepModal,\r\n    },\r\n    props: {\r\n        agentlevelId:{\r\n            required: true,\r\n        }\r\n    },\r\n    methods:{\r\n        /**\r\n         * @msg: 时间处理\r\n         * @param {type} \r\n         * @return: \r\n         */\r\n        timechange(time,type){\r\n            return timeStamp2String(time,type)\r\n        },\r\n        /**\r\n         * @msg: 获取等级详情\r\n         * @param {type} \r\n         * @return: \r\n         */\r\n        getAgentLevelInfo(){\r\n            getAgentLevelInfoAPI(this.agentid)\r\n                .then(res => {\r\n                    const  agentleveldata =res.data.data\r\n                    this.dataForm=agentleveldata\r\n                    if(agentleveldata.firstDiscount!=null &&agentleveldata.firstDiscount!=''){\r\n                        this.isDiscount=1\r\n                    }\r\n                    this.dataForm.isTask=''+this.dataForm.isTask\r\n                    console.log(this.dataForm)\r\n                    this.dataForm.stockDiscount=Number(this.dataForm.stockDiscount)*100\r\n                })\r\n                .catch(err => {\r\n                    this.tableLoading = false;\r\n                })\r\n        },\r\n        dataFormSubmit () {\r\n          let that=this;\r\n            this.$refs['dataForm'].validate((valid) => {\r\n                if(valid){\r\n                    const params =this.dataForm\r\n                    params.id=Number(params.id)\r\n                    params.stockType=1\r\n                    const pushdata={\r\n                        stockType:1,\r\n                        stockDiscount:Number(params.stockDiscount)/100,\r\n                        id:params.id,\r\n                        firstDiscount: params.firstDiscount,\r\n                        isDarklevel: params.isDarklevel,\r\n                        isTask: Number(params.isTask),\r\n                        level:  params.level,\r\n                        minStock: Number(params.minStock),\r\n                        nick: params.nick,\r\n                        registPrompt: params.registPrompt,\r\n                        taskAmount: Number(params.taskAmount),\r\n                        timeLimit: params.timeLimit,\r\n                    }\r\n                    postAgentLevelUpdateAPI(pushdata)\r\n                        .then(res => {\r\n                            const sucresponse = res.data;\r\n                            if(sucresponse.code==200){\r\n                            this.$message({\r\n                                type: 'success',\r\n                                message: '修改等级成功',\r\n                            });\r\n                            this.$emit('close-form')\r\n                            this.$emit('finish-action')\r\n                            }else{\r\n                            this.errorMsg(sucresponse.message)\r\n                            }\r\n                        })\r\n                        .catch(err => {\r\n                        console.log(err)\r\n                            this.tableLoading = false;\r\n                        }) \r\n                }\r\n            })\r\n        },errorMsg (message) {\r\n            this.$message({\r\n                message: message,\r\n                type: 'error',\r\n                duration: 1500\r\n            })\r\n        },\r\n    },\r\n    mounted(){\r\n        console.log(this.agentlevelId)\r\n        this.agentid=this.agentlevelId\r\n        this.getAgentLevelInfo()\r\n    }\r\n}\r\n",null]}