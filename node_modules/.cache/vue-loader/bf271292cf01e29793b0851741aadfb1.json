{"remainingRequest":"E:\\HtmlProjects\\wsadmin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\HtmlProjects\\wsadmin\\src\\components\\LoginPage.vue?vue&type=style&index=0&id=5faf54d0&scoped=scoped&lang=less&","dependencies":[{"path":"E:\\HtmlProjects\\wsadmin\\src\\components\\LoginPage.vue","mtime":1575020476406},{"path":"E:\\HtmlProjects\\wsadmin\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"E:\\HtmlProjects\\wsadmin\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\HtmlProjects\\wsadmin\\node_modules\\postcss-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\HtmlProjects\\wsadmin\\node_modules\\less-loader\\dist\\cjs.js","mtime":1576862572617},{"path":"E:\\HtmlProjects\\wsadmin\\node_modules\\style-resources-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\HtmlProjects\\wsadmin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1576862582236},{"path":"E:\\HtmlProjects\\wsadmin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.wrapper--login {\n    width: 100%;\n    min-height: 500px;\n    position: absolute;\n    top: 0;\n    bottom: 0;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    background: url(\"../assets/images/bg.jpg\") center no-repeat;\n    background-size: cover;\n}\n.form--login {\n    width: 400px;\n    min-height: 200px;\n    padding: 30px 20px;\n    background: rgba(0, 0, 0, 0.6);\n    border-radius: 6px;\n}\n.captcha--wrapper {\n    height: 40px;\n\n    img {\n        height: 100%;\n        background: #fff;\n    }\n}\n.loginheader{\n    font-size: 30px;\n    text-align: center;\n    margin: 10px auto;\n    color: #fff;\n}\n",{"version":3,"sources":["LoginPage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"LoginPage.vue","sourceRoot":"src\\components","sourcesContent":["<!-- 登陆页面 -->\n<template>\n    <div class=\"child-vhc wrapper--login\">\n        <div class=\"form--login\">\n            <el-form ref=\"formLogin\" :model=\"formLogin\" :rules=\"rules\">\n                <div class=\"loginheader\">微商后台管理系统</div>\n                <el-form-item prop=\"phone\">\n                    <el-input placeholder=\"请输入手机号\" v-model=\"formLogin.phone\"></el-input>\n                </el-form-item>\n                <el-form-item prop=\"password \">\n                    <el-input placeholder=\"请输入密码\" type=\"password\" v-model=\"formLogin.password\"></el-input>\n                </el-form-item>\n                <el-form-item prop=\"code\">\n                    <el-row :gutter=\"6\">\n                        <el-col :span=\"16\">\n                            <el-input placeholder=\"请输入验证码\" v-model=\"formLogin.code\"></el-input>\n                        </el-col>\n                        <el-col :span=\"8\">\n                            <el-button @click=\"getcode\">{{count?count+'S':'获取验证码'}}</el-button>\n                        </el-col>\n                     </el-row>\n                </el-form-item>\n                <el-form-item>\n                    <el-button type=\"primary\" @click=\"submitLoginForm\">提交</el-button>\n                </el-form-item>\n            </el-form>\n        </div>\n    </div>\n</template>\n\n<script>\nimport {mapMutations, mapState, mapActions} from 'vuex'\n\nimport {BASE_URL} from '@/public/constant'\nimport {loginAPI,getCodeAPI} from '@/api/globalAPI'\n\nexport default {\n    name: 'HelloWorld',\n    data() {\n        return {\n            codeImg: null,\n            formLogin: {\n                phone: '',\n                password: '',\n                code: '',\n            },\n            count:\"\",\n            timer:null,\n            rules: {\n                username: [\n                    {\n                        required: true,\n                        message: '请输入用户名',\n                        trigger: 'blur'\n                    }\n                ],\n                password: [\n                    {\n                        required: true,\n                        message: '请输入密码',\n                        trigger: 'blur'\n                    }\n                ],\n                code: [\n                    {\n                        required: true,\n                        message: '请输入验证码',\n                        trigger: 'blur'\n                    }\n                ],\n            },\n        };\n    },\n    methods: {\n\n        /**\n         * 提交登陆操作\n         */\n        submitLoginForm() {\n            const formLogin = {\n                ...this.formLogin\n            }\n            this.$refs.formLogin.validate(valid => {\n                if (valid) {\n                    loginAPI(formLogin).then(res => {\n                        const {code, data, message} = res.data\n                        console.log(res.data)\n                        console.log(code)\n                        if (code === 200) {\n                            var millisecond = new Date().getTime();\n                            var expiresTime = new Date(millisecond +60*60 * 1000);\n                            // console.log(expiresTime)\n                            // Cookies.set('token', 'value', {\n                            //     expires: expiresTime,\n                            // });\n                            // document.cookie = \"token=\"+  data.token + \";expires=\" + expiresTime.toGMTString();\n                            localStorage.setItem('token', data.token)\n                            // localStorage.setItem('tokendate',expiresTime)\n                            console.log(data)\n                            sessionStorage.setItem('token', data.admin.token)\n                            sessionStorage.setItem('roleId', data.admin.roleId)\n                            sessionStorage.setItem('uid', data.admin.uid)\n                            // localStorage.setItem('rid', data.tid)\n                            // localStorage.setItem('username', formLogin.username)\n\n                            this.$message({type: 'success', message: '登陆成功！'})\n                            // 改变登录状态为已登录\n                            this\n                                .$store\n                                .commit('moduleLogin/login')\n                            // 跳转到应用\n                            this\n                                .$router\n                                .push('/')\n                        } else {\n                            this.$message({type: 'error', message: message})\n                        }\n                    })\n                }\n            })\n           \n        },\n        getcode(){\n            const that =this\n            if(!this.timer){\n                 if(!(/^1[3456789]\\d{9}$/.test(this.formLogin.phone))){ \n                    this.$message({type: 'error', message: '请输入正确的手机号码'}) \n                    return false; \n            }else{\n                const pushdata={\n                    phone:this.formLogin.phone\n                }\n                const TIME_COUNT = 60;\n                 if (!this.time) {\n                        this.count = TIME_COUNT;\n                        this.timer = setInterval(() => {\n                        if (this.count > 0 && this.count <= TIME_COUNT) {\n                            this.count--;\n                            } else {\n                            this.show = true;\n                            clearInterval(this.timer);\n                            this.timer = null;\n                            }\n                        }, 1000)\n                    }\n                    getCodeAPI(pushdata)\n                    .then(res => {\n                            const response = res.data;\n                            if(response.code==200){\n                                this.$message({\n                                    type: 'success',\n                                    message: '获取验证码成功',\n                                });\n                            }\n                        })\n                        .catch(err => {\n                        console.log(err)\n                            this.tableLoading = false;\n                        }) \n                }\n            }\n        },\n        errorMsg (message) {\n            this.$message({\n                message: message,\n                type: 'error',\n                duration: 1500\n            })\n        },\n    },\n    mounted() {\n    }\n}\n</script>\n\n<style scoped=\"scoped\" lang=\"less\">\n    .wrapper--login {\n        width: 100%;\n        min-height: 500px;\n        position: absolute;\n        top: 0;\n        bottom: 0;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        background: url(\"../assets/images/bg.jpg\") center no-repeat;\n        background-size: cover;\n    }\n    .form--login {\n        width: 400px;\n        min-height: 200px;\n        padding: 30px 20px;\n        background: rgba(0, 0, 0, 0.6);\n        border-radius: 6px;\n    }\n    .captcha--wrapper {\n        height: 40px;\n\n        img {\n            height: 100%;\n            background: #fff;\n        }\n    }\n    .loginheader{\n        font-size: 30px;\n        text-align: center;\n        margin: 10px auto;\n        color: #fff;\n    }\n</style>"]}]}