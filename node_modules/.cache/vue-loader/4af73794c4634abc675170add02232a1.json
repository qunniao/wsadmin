{"remainingRequest":"E:\\HtmlProjects\\wsadmin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\HtmlProjects\\wsadmin\\src\\components\\prodTwo\\prodInfo.vue?vue&type=style&index=0&id=d83452e2&scoped=scoped&lang=less&","dependencies":[{"path":"E:\\HtmlProjects\\wsadmin\\src\\components\\prodTwo\\prodInfo.vue","mtime":1573375139543},{"path":"E:\\HtmlProjects\\wsadmin\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"E:\\HtmlProjects\\wsadmin\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\HtmlProjects\\wsadmin\\node_modules\\postcss-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\HtmlProjects\\wsadmin\\node_modules\\less-loader\\dist\\cjs.js","mtime":1576862572617},{"path":"E:\\HtmlProjects\\wsadmin\\node_modules\\style-resources-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\HtmlProjects\\wsadmin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1576862582236},{"path":"E:\\HtmlProjects\\wsadmin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.mbline{\n  margin-top:24px;\n  padding-left: 20px;\n  line-height: 40px;\n  background: rgb(249, 249, 249);\n}\n\n.avatar-uploader .el-upload {\n    border: 1px dashed #d9d9d9;\n    border-radius: 6px;\n    cursor: pointer;\n    position: relative;\n    overflow: hidden;\n  }\n  .avatar-uploader .el-upload:hover {\n    border-color: #409EFF;\n  }\n  .avatar-uploader-icon {\n    font-size: 28px;\n    color: #8c939d;\n    width: 178px;\n    height: 178px;\n    line-height: 178px;\n    text-align: center;\n  }\n  .avatar {\n    width: 178px;\n    height: 178px;\n    display: block;\n  }\n",{"version":3,"sources":["prodInfo.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAm1BA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"prodInfo.vue","sourceRoot":"src\\components\\prodTwo","sourcesContent":["<template>\n  <div class=\"mod-prod-info\">\n    <el-form :model=\"dataForm\"\n             ref=\"dataForm\"\n             :rules=\"rules\"\n             label-width=\"150px\">\n      <el-form-item label=\"商品名称:\"\n                    prop=\"productName\"\n                    :rules=\"[{ required: true, message: '商品名称不能为空'}]\">\n        <el-col :span=\"8\">\n          <el-input v-model=\"dataForm.productName\"\n                    placeholder=\"请输入\"\n                    maxlength=\"50\"></el-input>\n        </el-col>\n      </el-form-item>\n      <el-form-item label=\"商品主图:\" prop=\"picfile\">\n        <el-upload\n            class=\"avatar-uploader\"\n            action=\"http://admin.zhanchengwlkj.com:8080/derivative_system_backstage/file/addFile\"\n            :show-file-list=\"false\"\n            :auto-upload=\"true\"\n            name=\"files\"\n            :on-success=\"uploadImg\"\n            :before-upload=\"beforeAvatarUpload\">\n            <img v-if=\"dataForm.cover\" :src=\"dataForm.cover\" class=\"avatar\">\n            <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\n        </el-upload>\n      </el-form-item>\n      <el-form-item label=\"商品图片:\">\n       <el-upload\n        action=\"http://admin.zhanchengwlkj.com:8080/derivative_system_backstage/file/addFile\"\n        list-type=\"picture-card\"\n        name='files'\n        :file-list=\"dataForm.productImageDtos\"\n        :auto-upload=\"true\"\n        :on-success=\"uploadImgTwo\"\n        :on-preview=\"handlePictureCardPreview\"\n        :on-remove=\"handleRemove\">\n        <i class=\"el-icon-plus\"></i>\n      </el-upload>\n      <el-dialog :visible.sync=\"dialogVisible\">\n        <img width=\"100%\" :src=\"dialogImageUrl\" alt=\"\">\n      </el-dialog>\n      </el-form-item>\n      <el-form-item label=\"商品货号:\"\n                    prop=\"productNumber\"\n                    :rules=\"[{ required: true, message: '商品货号不能为空'}]\">\n        <el-col :span=\"8\">\n          <el-input v-model=\"dataForm.productNumber\"\n                    placeholder=\"请输入\"\n                    maxlength=\"50\"></el-input>\n        </el-col>\n      </el-form-item>\n      <el-form-item label=\"商品零售价:\"\n                    prop=\"price\"\n                    :rules=\"[{ required: true, message: '商品零售价不能为空'}]\">\n        <el-col :span=\"8\">\n          <el-input v-model=\"dataForm.price\"\n                    placeholder=\"请输入\"\n                    maxlength=\"50\"></el-input>\n        </el-col>\n      </el-form-item>\n      <el-form-item label=\"商品市场价:\"\n                    prop=\"marketPrice\"\n                    :rules=\"[{ required: true, message: '商品市场价格不能为空'}]\">\n        <el-col :span=\"8\">\n          <el-input v-model=\"dataForm.marketPrice\"\n                    placeholder=\"请输入\"\n                    maxlength=\"50\"></el-input>\n        </el-col>\n      </el-form-item>\n      <el-form-item label=\"进货价:\"\n                    prop=\"stockPrice\">\n        <el-col :span=\"8\">\n          <el-input v-model=\"dataForm.stockPrice\"\n                    placeholder=\"请输入\"\n                    maxlength=\"50\"></el-input>\n        </el-col>\n      </el-form-item>\n      <el-form-item label=\"邀请奖励金额:\"\n                    prop=\"inviteReward\">\n        <el-col :span=\"8\">\n          <el-input v-model=\"dataForm.inviteReward\"\n                    placeholder=\"请输入\"\n                    maxlength=\"50\"></el-input>\n        </el-col>\n      </el-form-item>\n      <el-form-item label=\"装箱数:\"\n                    prop=\"weight\"\n                    :rules=\"[{ required: true, message: '装箱数不能为空'}]\">\n        <el-col :span=\"8\">\n          <el-input v-model=\"dataForm.weight\"\n                    placeholder=\"请输入\"\n                    maxlength=\"50\"></el-input>\n        </el-col>\n      </el-form-item>\n      <el-form-item label=\"（必选）商品分类:\">\n        <el-col :span=\"8\">\n          <el-button @click=\"handleSecondDepShow\" type=\"primary\">选择分类</el-button>\n        </el-col>\n      </el-form-item>\n      <el-form-item>\n          <el-tag\n            v-for=\"item in shoptypelist\"\n            :key=\"item.tid\"\n            closable\n            @close='delshoptype(item.tid)'\n            >\n            {{item.typeName}}\n          </el-tag>\n      </el-form-item>\n      <el-form-item label=\"商品属性组:\">\n        <el-col :span=\"8\">\n          <el-button @click=\"handleAttributeDepShow\" type=\"primary\">选择属性组</el-button>\n        </el-col>\n      </el-form-item>\n      <el-form-item >\n        <el-col :span=\"8\">\n          <el-input v-model=\"attrtext\"\n                    placeholder=\"请输入\"\n                    maxlength=\"50\"></el-input>\n        </el-col>\n          <el-button @click=\"saveattrtext\">添加</el-button>\n      </el-form-item>\n      <el-form-item\n          v-for=\"(domain, index) in attributeDepList\"\n          :label=\"domain.name\"\n          :key=\"index\"\n          :rules=\"{\n            required: true, message: '属性值不能为空', trigger: 'blur'\n          }\"\n        >\n        <el-col :span=\"8\">\n          <el-input v-model=\"domain.value\"></el-input>\n        </el-col>\n        <el-button @click.prevent=\"removeDomain(domain)\">删除</el-button>\n      </el-form-item>\n      <el-collapse  @change=\"handleChange\">\n        <el-collapse-item title=\"更多设置\" name=\"1\">\n          <el-form-item label=\"下单时是否显示库存:\">\n            <el-radio-group v-model=\"dataForm.showStock\">\n              <el-radio :label=\"1\">是</el-radio>\n              <el-radio :label=\"0\">否</el-radio>\n            </el-radio-group>\n          </el-form-item>\n          <el-form-item label=\"商品排序:\"\n                    prop=\"sort\">\n            <el-col :span=\"8\">\n              <el-input v-model=\"dataForm.sort\"\n                        placeholder=\"请输入\"\n                        maxlength=\"50\"></el-input>\n            </el-col>\n          </el-form-item>\n          <el-form-item label=\"基础销量:\"\n                    prop=\"sales\">\n            <el-col :span=\"8\">\n              <el-input v-model=\"dataForm.sales\"\n                        placeholder=\"请输入\"\n                        maxlength=\"50\"></el-input>\n            </el-col>\n          </el-form-item>\n          <!-- <el-form-item label=\"商品箱规设置:\"\n                    prop=\"units\"\n                    :rules=\"[{ required: true, message: '商品箱规不能为空'}]\">\n            <el-col :span=\"8\">\n              <el-button @click=\"handleSecondDepShow\" type=\"primary\">选择分类</el-button>\n            </el-col>\n          </el-form-item> -->\n          <!-- 商品规格 -->\n          <sku-tag ref=\"skuTag\"\n               @change=\"skuTagChangeSkuHandler\"></sku-tag>\n          <sku-table ref=\"skuTable\"\n                 v-model=\"skuList\"\n                 :prodName.sync=\"prodName\"></sku-table>\n        </el-collapse-item>\n      </el-collapse>\n      <div  class=\"mbline\">运费模板</div>\n      <el-form-item label=\"配送方式\">\n        <div >\n          <el-radio v-model=\"dataForm.isUniformFreight\" label=\"0\">分别设置</el-radio>\n          <el-form-item  label-width=\"180px\" label=\"零售运费模板：\">\n            <el-select v-model=\"dataForm.retailFreightId\" v-bind:disabled=\"dataForm.isUniformFreight==1\"  placeholder=\"请选择\">\n              <el-option\n                v-for=\"item in freightlist\"\n                :key=\"item.id\"\n                :label=\"item.title\"\n                :value=\"item.id\">\n              </el-option>\n            </el-select>\n          </el-form-item>\n          <el-form-item style=\"margin-top:10px\" label-width=\"180px\" label=\"代理运费模板：\">\n            <el-select v-model=\"dataForm.agentFreightId\"  v-bind:disabled=\"dataForm.isUniformFreight==1\" placeholder=\"请选择\">\n              <el-option\n                v-for=\"item in freightlist\"\n                :key=\"item.id\"\n                :label=\"item.title\"\n                :value=\"item.id\">\n              </el-option>\n            </el-select>\n          </el-form-item>\n          <el-form-item style=\"margin-top:10px\" label-width=\"180px\" label=\"云仓库提货运费模板：\">\n            <el-select v-model=\"dataForm.cloudFreightId\" v-bind:disabled=\"dataForm.isUniformFreight==1\" placeholder=\"请选择\">\n              <el-option\n                v-for=\"item in freightlist\"\n                :key=\"item.id\"\n                :label=\"item.title\"\n                :value=\"item.id\">\n              </el-option>\n            </el-select>\n          </el-form-item>\n        </div>\n        <div>\n          <el-radio v-model=\"dataForm.isUniformFreight\" label=\"1\">统一设置</el-radio>\n          <el-form-item label-width=\"180px\" label=\"设置：\">\n            <el-select v-model=\"allfreight\"  placeholder=\"请选择\">\n              <el-option\n                v-for=\"item in freightlist\"\n                :key=\"item.id\"\n                :label=\"item.title\"\n                :value=\"item.id\">\n              </el-option>\n            </el-select>\n          </el-form-item>\n        </div>\n      </el-form-item>\n      <div  class=\"mbline\">上下架/其他</div>\n      <el-form-item label-width=\"180px\" label=\"代理方式：\" prop=\"checkList\">\n          <el-checkbox-group v-model=\"dataForm.checkList\"  >\n                <el-checkbox label=\"物流进货\"  ></el-checkbox>\n                <el-checkbox label=\"云仓库储货\" ></el-checkbox>\n          </el-checkbox-group>\n      </el-form-item>\n      <el-form-item label-width=\"180px\" label=\"上架时间\">\n          <el-radio v-model=\"shopup\" label=\"1\">立即上架</el-radio>\n          <el-radio v-model=\"shopup\" label=\"2\">定时上架</el-radio>\n          <el-radio v-model=\"shopup\" label=\"3\">暂不上架</el-radio>\n          <el-form-item  v-if=\"shopup==2\">\n            <el-date-picker\n              v-model=\"dataForm.putawayTime\"\n              type=\"datetime\"\n              value-format=\"yyyy-MM-dd HH:mm:ss\"\n              placeholder=\"选择日期时间\">\n            </el-date-picker>\n          </el-form-item>\n      </el-form-item>\n      <el-form-item v-if=\"shopup!=3\" label-width=\"180px\" label=\"定时下架\">\n          <el-radio v-model=\"shopdown\" label=\"1\">是</el-radio>\n          <el-radio v-model=\"shopdown\" label=\"2\">否</el-radio>\n          <el-form-item  v-if=\"shopdown==1\">\n            <el-date-picker\n              v-model=\"dataForm.soldoutTime\"\n              type=\"datetime\"\n              value-format=\"yyyy-MM-dd HH:mm:ss\"\n              placeholder=\"选择日期时间\">\n            </el-date-picker>\n          </el-form-item>\n      </el-form-item>\n      <el-form-item  label=\"商品详情：\">\n          <div id=\"editorElem\"  style=\"text-align:left\"></div>\n      </el-form-item>\n      <el-form-item>\n        <el-button type=\"primary\"\n                   @click=\"dataFormSubmit()\">确定</el-button>\n      </el-form-item>\n       <el-dialog\n            title=\"商品分类\"\n            :append-to-body=\"true\"\n            :visible.sync=\"secondDepShow\"\n            width=\"60%\">\n                <second-index\n                v-if=\"secondDepShow\"\n                @changetype=\"changeshoptype\"\n                :prodtype-list=\"shoptypelist\"\n                @close-form=\"secondDepShow = false\"\n                ></second-index>\n        </el-dialog>\n        <el-dialog\n            title=\"商品属性组\"\n            :append-to-body=\"true\"\n            :visible.sync=\"AttributeDepShow\"\n            width=\"60%\">\n                <attribute-index\n                v-if=\"AttributeDepShow\"\n                @changeattrlist=\"changeattrlist\"\n                @close-form=\"AttributeDepShow = false\"\n                ></attribute-index>\n        </el-dialog>\n    </el-form>\n  </div>\n</template>\n\n<script>\nconst AttributeIndex = () => import('./shopAttribute.vue');\nconst SecondIndex = () => import('./shoptype.vue');\nimport {\n  getProdDetailAPI,\n  getTemplateListAPI,\n  pushProdDataAPI,\n  putProdDataAPI\n}from '@/api/productApi.js'\nimport axios from 'axios';\nimport { treeDataTranslate, idList } from '@/utils'\nimport E from 'wangeditor';\nimport SkuTable from './sku-table'\nimport SkuTag from './sku-tag'\nexport default {\n   name:'editor',\n  data () {\n    return {\n      // 分类树展示与回显\n      transportId: null,\n      shopid:0,\n      shopup:'1',\n      shopdown:'1',\n      value1:'',\n      attrtext:'',\n      attributeDepList:[],\n      category: {\n        list: [],\n        selected: [],\n        props: {\n          value: 'categoryId',\n          label: 'categoryName'\n        }\n      },\n      rules: {\n        checkList: [\n                { type: 'array', required: true, message: '请选择代理购买方式', trigger: 'change' }\n              ],\n        picfile: [ \n            { required: true, message: '请上传图片' }          \n          ]\n      },\n      fileList:[],\n      freightlist:[],\n      allfreight:'',\n      AttributeDepShow:false,\n      secondDepShow:false,\n      imageShowUrl:'',\n      // 规格列表\n      shoptypelist:[],\n      skuList:[],\n      prodName:'',\n      dialogImageUrl: '',\n      dialogVisible: false,\n      dataForm: {\n        checkList:[],\n        productType:0,\n        sid:0,\n        productNumber:'',\n        productName: '',\n        cover:'',\n        productIntro:'',\n        price:'',\n        inviteReward:'',\n        marketPrice:'',\n        weight:'',\n        stockPrice:'',\n        isUniformFreight:'0',\n        showStock:1,\n        content:'',\n        retailFreightId:'',\n        agentFreightId:'',\n        cloudFreightId:'',\n        sales:'',\n        agentBuy:'',\n        sort:'',\n        putawayTime:'',\n        soldoutTime:'',\n        typeIds:[],\n        productParams:[],\n        units:[],\n        standardDtos:[],\n        productImageDtos:[]\n      },\n      tags: [],\n      // resourcesUrl: window.SITE_CONFIG.resourcesUrl\n    }\n  },\n  components: {\n    SkuTable,\n    SkuTag,\n    SecondIndex,\n    AttributeIndex\n  },\n  props: {\n    depId: {\n      required: true,\n    },\n  },\n  computed: {\n    defalutSku () {\n      return this.$store.state.prod.defalutSku\n    }\n  },\n  activated () {\n    this.dataForm.prodId = this.$route.query.prodId\n    this.getDataList()\n  },\n  methods: {\n    // 获取分类数据\n    getDataList () {\n     \n    },\n    handleRemove(file, fileList) {\n      for(let i=0;i<this.dataForm.productImageDtos.length;i++){\n        if(file.url==this.dataForm.productImageDtos[i].url){\n          this.dataForm.productImageDtos.splice(i,1)\n        }\n      }\n    },\n    uploadImgTwo(res){\n      this.dataForm.productImageDtos.push({\n        sort:0,\n        url:res.data\n      })\n    },\n    handlePictureCardPreview(file) {\n        this.dialogImageUrl = file.url;\n        this.dialogVisible = true;\n    },\n    removeDomain(item) {\n        for(let j=0;j<this.attributeDepList.length;j++){\n          if(this.attributeDepList[j].name==item.name){\n            this.attributeDepList.splice(j,1)\n          }\n        }\n      },\n    delshoptype(deltid){\n     for(let i=0;i<this.shoptypelist.length;i++){\n       if(this.shoptypelist[i].tid==deltid){\n         this.shoptypelist.splice(i,1)\n       }\n     }\n    },\n    saveattrtext(){\n      let isokpush =true;\n      for(let j=0;j<this.attributeDepList.length;j++){\n          if(this.attributeDepList[j].name==this.attrtext){\n            isokpush=false\n            this.$message({\n              type: 'error',\n              message: '不能添加已有属性值',\n            });\n          }\n      }\n      if(isokpush){\n        if(this.attrtext!=''){\n            this.attributeDepList.push({\n            name:this.attrtext,\n            value:''\n          })\n          \n          this.attrtext=''\n        }else{\n          this.$message({\n              type: 'error',\n              message: '属性值不能为空',\n            });\n        }\n      }\n    },\n    changeshoptype(typelist){\n      this.shoptypelist=typelist\n    },\n    changeattrlist(attrlist){\n      let attribute =attrlist.split(',')\n      for(let i=0;i<attribute.length;i++){\n        let ischeck=true\n        for(let j=0;j<this.attributeDepList.length;j++){\n          if(this.attributeDepList[j].name==attribute[i]){\n            ischeck=false\n          }\n        }\n        if(ischeck){\n          this.attributeDepList.push({name:attribute[i],value:''})\n        }\n      }\n    },\n    handleChange(){\n      \n    },\n    handleSecondDepShow(){\n      this.secondDepShow = true;\n    },\n    handleAttributeDepShow(){\n      this.AttributeDepShow=true\n    },\n    uploadImg(res){\n      this.dataForm.cover = res.data;\n      this.imageShowUrl=res.data\n      this.rules.picfile = [{ required: true, message: '请上传图片' }] \n      if (this.dataForm.cover!='') {\n        this.rules.picfile = []\n      }\n    },\n    beforeAvatarUpload(file) {\n      const isJPG = file.type === 'image/jpeg' || file.type === 'image/png';\n      const isLt2M = file.size / 1024 / 1024 < 2;\n\n      if (!isJPG) {\n        this.$message.error('上传头像图片只能是 JPG或者PNG 格式!');\n      }\n      if (!isLt2M) {\n        this.$message.error('上传头像图片大小不能超过 2MB!');\n      }\n      return isJPG && isLt2M;\n    },    \n    // 获取分类信息\n    getCategoryList () {\n    },\n    // 选择分类改变事件\n    handleCategoryChange (val) {\n      this.dataForm.categoryId = val[val.length - 1]\n    },\n    // 表单提交\n    dataFormSubmit () {\n          let that=this;\n        this.$refs['dataForm'].validate((valid) => {\n          if(valid){\n            if(this.shoptypelist.length<1){\n              this.$message({\n                type: 'error',\n                message: '产品分类不能为空',\n              });\n              return false\n            }\n            const pushdata =this.dataForm\n            if(this.dataForm.checkList.length==0){\n              pushdata.agentBuy=0\n            }else if(this.dataForm.checkList.length==2){\n              pushdata.agentBuy=3\n            }else{\n              if(this.dataForm.checkList[0]=='物流进货'){\n                pushdata.agentBuy=1\n              }else{\n                pushdata.agentBuy=2\n              }\n            }\n            if(this.shopup==1){\n              pushdata.putawayTime=0\n              if(this.shopdown==2){\n                pushdata.soldoutTime=0\n              }\n            }else if(this.shopup==3){\n              pushdata.putawayTime=0\n              pushdata.soldoutTime=0\n            }else{\n              if(this.shopdown==2){\n                pushdata.soldoutTime=0\n              }\n            }\n            pushdata.standardDtos=[]\n            pushdata.productGuigeNames=[]\n            if(this.skuList.length>0){\n               let skuguigelist =this.skuList[0].properties.split(';')\n               if(skuguigelist.length==1){\n                 pushdata.productGuigeNames.push({\n                   gname:skuguigelist[0],\n                   lvevl:1\n                 })\n               }else{\n                  pushdata.productGuigeNames.push({\n                   gname:skuguigelist[0],\n                   lvevl:1\n                 },{\n                   gname:skuguigelist[1],\n                   lvevl:2\n                 })\n               }\n            }\n            for(let i=0;i<this.skuList.length;i++){\n              let skulistdata={\n                sp1:'',\n                sp2:'',\n                productNumber:'',\n                price:'',\n                weight:'',\n                pic:''\n              }\n              let skulistsplist =this.skuList[i].properties.split(';')\n              if(skulistsplist.length<=1){\n                  skulistdata.sp1=skulistsplist[0].split(':')[1]\n                  skulistdata.productNumber=this.skuList[i].productNumber\n                  skulistdata.weight=this.skuList[i].weight\n                  skulistdata.price=this.skuList[i].price\n                  skulistdata.pic=this.skuList[i].pic\n              }else{\n                  skulistdata.sp1=skulistsplist[0].split(':')[1]\n                  skulistdata.sp2=skulistsplist[1].split(':')[1]\n                  skulistdata.productNumber=this.skuList[i].productNumber\n                  skulistdata.weight=this.skuList[i].weight\n                  skulistdata.price=this.skuList[i].price\n                  skulistdata.pic=this.skuList[i].pic\n              }\n              pushdata.standardDtos.push(skulistdata)\n            }\n            pushdata.typeIds=[]\n            for(let i=0;i<this.shoptypelist.length;i++){\n              pushdata.typeIds.push(this.shoptypelist[i].tid)\n            }\n            if(this.dataForm.isUniformFreight==2){\n              pushdata.retailFreightId=this.allfreight\n              pushdata.agentFreightId=this.allfreight\n              pushdata.cloudFreightId=this.allfreight\n            }\n            pushdata.productType=1\n            if(this.shopid!=0){\n              const putdata={\n                pid:this.shopid,\n                productType:1,\n                productNumber:pushdata.productNumber,\n                cover:pushdata.cover,\n                productName:pushdata.productName,\n                productIntro:'',\n                price:pushdata.price,\n                isUniformFreight:pushdata.isUniformFreight,\n                marketPrice:pushdata.marketPrice,\n                weight:pushdata.weight,\n                showStock:pushdata.showStock,\n                content:pushdata.content,\n                retailFreightId:pushdata.retailFreightId,\n                agentFreightId:pushdata.agentFreightId,\n                cloudFreightId:pushdata.cloudFreightId,\n                sales:pushdata.sales,\n                sort:pushdata.sort,\n                inviteReward:pushdata.inviteReward,\n                stockPrice:pushdata.stockPrice,\n                putawayTime:pushdata.putawayTime,\n                soldoutTime:pushdata.soldoutTime,\n                typeIds:pushdata.typeIds,\n                productParams:pushdata.productParams,\n                units:pushdata.units,\n                standardDtos:pushdata.standardDtos,\n                productImageDtos:pushdata.productImageDtos,\n              }\n              putProdDataAPI(putdata)\n                .then(res => {\n                    const sucresponse = res.data;\n                    if(sucresponse.code==200){\n                      this.$message({\n                        type: 'success',\n                        message: '修改产品成功',\n                      });\n                      this.$emit('close-form')\n                      this.$emit('finish-action')\n                    }else{\n                      this.errorMsg(sucresponse.message)\n                    }\n                })\n                .catch(err => {\n                  console.log(err)\n                    this.tableLoading = false;\n                }) \n            }else{\n              pushProdDataAPI(pushdata)\n                .then(res => {\n                    const response = res.data;\n                    if(response.code==200){\n                      this.$message({\n                        type: 'success',\n                        message: '添加产品成功',\n                      });\n                      this.$emit('close-form')\n                      this.$emit('finish-action')\n                    }else{\n                      this.errorMsg(response.message)\n                    }\n                })\n                .catch(err => {\n                  console.log(err)\n                    this.tableLoading = false;\n                })            \n            }\n          }\n         \n        })\n    },\n    paramSetPriceAndStocks (param) {\n      \n    },\n    skuTagChangeSkuHandler (skuList) {\n      const prodName = this.prodName\n      skuList.forEach(sku => {\n        if (sku.properties) {\n          sku.skuName = ''\n          let properties = sku.properties.split(';')\n          for (const propertiesKey in properties) {\n            sku.skuName += properties[propertiesKey].split(':')[1] + ' '\n          }\n          sku.prodName = prodName + ' ' + sku.skuName\n        }\n      })\n      this.skuList = skuList\n    },\n    getproddetail(id){\n      getProdDetailAPI(id)\n        .then(res => {\n          const data = res.data.data;\n          this.dataForm=data\n          this.dataForm.productImageDtos=data.productImageList\n          this.rules.picfile = [{ required: true, message: '请上传图片' }] \n          if (this.dataForm.cover!='') {\n            this.rules.picfile = []\n          }\n          if(data.agentBuy=0){\n              this.dataForm.checkList=[]\n          }else if(data.agentBuy=3){\n              this.dataForm.checkList=[\"物流进货\",\"云仓库储货\"]\n          }else{\n              if( data.agentBuy=1){\n                this.dataForm.checkList=[\"物流进货\"]\n              }else{\n                this.dataForm.checkList=[\"云仓库储货\"]\n              }\n          }\n          this.shoptypelist=data.productTypeList\n          this.dataForm.isUniformFreight=data.isUniformFreight\n          this.attributeDepList=data.productParamList\n          let skulistData =data.productSkuList\n          let skunamelist =data.productGuigeNameList\n          for(let i=0;i<skulistData.length;i++){\n            let skulistpushdata ={\n              pic: \"\",\n              price: 0,\n              prodName: \" 标签值 二级标签值 \",\n              productNumber: 0,\n              properties: \"一级标签:标签值;二级标签:二级标签值\",\n              skuName: \"标签值 二级标签值 \",\n              status: 1,\n              weight: 0,\n            }\n            skulistpushdata.pic=skulistData[i].pic\n            skulistpushdata.price=skulistData[i].price\n            skulistpushdata.weight=skulistData[i].weight\n            skulistpushdata.productNumber=skulistData[i].productNumber\n            if(skunamelist.length==2){\n              skulistpushdata.properties=skunamelist[0].gname+':'+skulistData[i].sp1+';'+skunamelist[1].gname+':'+skulistData[i].sp2\n              skulistpushdata.skuName=skulistData[i].sp1 + ' '+skulistData[i].sp2\n              skulistpushdata.prodName=' '+skulistData[i].sp1 + ' '+skulistData[i].sp2+' '\n            }else{\n               skulistpushdata.skuName=skulistData[i].sp1\n               skulistpushdata.properties=skunamelist[0].gname+':'+skulistData[i].sp1\n               skulistpushdata.skuName=skulistData[i].sp1\n               skulistpushdata.prodName=' '+skulistData[i].sp1\n            }\n            this.skuList.push(skulistpushdata)\n          }\n          if(data.status==-1){\n              this.shopup=\"3\"\n            }else{\n              if(data.putawayTime==0){\n                this.shopup=\"1\"\n                if(data.soldoutTime!=0){\n                  this.shopdown=\"1\"\n                }else{\n                  this.shopdown=\"2\"\n                }\n              }else{\n                this.shopup=\"2\"\n                if(data.soldoutTime!=0){\n                  this.shopdown=\"1\"\n                }else{\n                  this.shopdown=\"2\"\n                }\n              }\n            }\n\n            var editor = new E('#editorElem')\n            editor.customConfig.onchange = (html) => {\n              this.dataForm.content = html\n            }\n            editor.customConfig.customUploadImg = (files, insert) => {\n              const formData = new FormData();\n              formData.append('files', files[0]);\n               axios.post(\"http://admin.zhanchengwlkj.com:8080/derivative_system_backstage/file/addFile\", formData, {\n                  headers: {\n                    \"Content-Type\": \"multipart/form-data\"\n                  }\n                }).then(res => {\n                  let { data } = res\n                  insert(data.data)  \n                  // 插入图片到editor\n                });\n              // formData.append('path', 'files/ne-icev3-dashboard/content/content/');\n              \n            };\n            editor.customConfig.uploadImgShowBase64 = true //图片以base64形式保存\n            editor.create()\n            editor.txt.html(this.dataForm.content)\n        })\n        .catch(err => {\n            this.tableLoading = false;\n        })\n    },\n    errorMsg (message) {\n      this.$message({\n        message: message,\n        type: 'error',\n        duration: 1500\n      })\n    },\n    getfreightlist(){\n        const getTempParam = {\n          current:1,\n          size:100\n        };\n        getTemplateListAPI(getTempParam)\n            .then(res => {\n                const response = res.data.data.records;\n                this.freightlist =response\n            })\n            .catch(err => {\n                this.tableLoading = false;\n            })\n    }\n  },\n  mounted() {\n        //wangEditor自带方法\n        if(this.depId!=0){\n          this.shopid=this.depId\n          this.getproddetail(this.depId)\n        }else{\n            var editor = new E('#editorElem')\n            editor.customConfig.uploadImgShowBase64 = true //图片以base64形式保存\n            editor.customConfig.onchange = (html) => {\n              this.dataForm.content = html\n            }\n            editor.customConfig.customUploadImg = (files, insert) => {\n              const formData = new FormData();\n              formData.append('files', files[0]);\n               axios.post(\"http://admin.zhanchengwlkj.com:8080/derivative_system_backstage/file/addFile\", formData, {\n                  headers: {\n                    \"Content-Type\": \"multipart/form-data\"\n                  }\n                }).then(res => {\n                  let { data } = res\n                  insert(data.data)  \n                  // 插入图片到editor\n                });\n              // formData.append('path', 'files/ne-icev3-dashboard/content/content/');\n              \n            };\n            editor.customConfig.uploadImgShowBase64 = true //图片以base64形式保存\n            editor.create()\n        }\n        this.getfreightlist()\n    },\n}\n</script>\n<style scoped=\"scoped\" lang=\"less\">\n.mbline{\n  margin-top:24px;\n  padding-left: 20px;\n  line-height: 40px;\n  background: rgb(249, 249, 249);\n}\n\n.avatar-uploader .el-upload {\n    border: 1px dashed #d9d9d9;\n    border-radius: 6px;\n    cursor: pointer;\n    position: relative;\n    overflow: hidden;\n  }\n  .avatar-uploader .el-upload:hover {\n    border-color: #409EFF;\n  }\n  .avatar-uploader-icon {\n    font-size: 28px;\n    color: #8c939d;\n    width: 178px;\n    height: 178px;\n    line-height: 178px;\n    text-align: center;\n  }\n  .avatar {\n    width: 178px;\n    height: 178px;\n    display: block;\n  }\n</style>"]}]}