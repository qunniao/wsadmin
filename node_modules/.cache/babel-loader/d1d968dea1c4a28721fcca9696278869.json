{"remainingRequest":"E:\\HtmlProjects\\wsadmin\\node_modules\\thread-loader\\dist\\cjs.js!E:\\HtmlProjects\\wsadmin\\node_modules\\babel-loader\\lib\\index.js!E:\\HtmlProjects\\wsadmin\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\HtmlProjects\\wsadmin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\HtmlProjects\\wsadmin\\src\\components\\LoginPage.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\HtmlProjects\\wsadmin\\src\\components\\LoginPage.vue","mtime":1575020476406},{"path":"E:\\HtmlProjects\\wsadmin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1576862582236},{"path":"E:\\HtmlProjects\\wsadmin\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\HtmlProjects\\wsadmin\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\HtmlProjects\\wsadmin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1576862582236},{"path":"E:\\HtmlProjects\\wsadmin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _objectSpread from \"E:\\\\HtmlProjects\\\\wsadmin\\\\node_modules\\\\@babel\\\\runtime/helpers/builtin/es6/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { mapMutations, mapState, mapActions } from 'vuex';\nimport { BASE_URL } from '@/public/constant';\nimport { loginAPI, getCodeAPI } from '@/api/globalAPI';\nexport default {\n  name: 'HelloWorld',\n  data: function data() {\n    return {\n      codeImg: null,\n      formLogin: {\n        phone: '',\n        password: '',\n        code: ''\n      },\n      count: \"\",\n      timer: null,\n      rules: {\n        username: [{\n          required: true,\n          message: '请输入用户名',\n          trigger: 'blur'\n        }],\n        password: [{\n          required: true,\n          message: '请输入密码',\n          trigger: 'blur'\n        }],\n        code: [{\n          required: true,\n          message: '请输入验证码',\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  methods: {\n    /**\n     * 提交登陆操作\n     */\n    submitLoginForm: function submitLoginForm() {\n      var _this = this;\n\n      var formLogin = _objectSpread({}, this.formLogin);\n\n      this.$refs.formLogin.validate(function (valid) {\n        if (valid) {\n          loginAPI(formLogin).then(function (res) {\n            var _res$data = res.data,\n                code = _res$data.code,\n                data = _res$data.data,\n                message = _res$data.message;\n            console.log(res.data);\n            console.log(code);\n\n            if (code === 200) {\n              var millisecond = new Date().getTime();\n              var expiresTime = new Date(millisecond + 60 * 60 * 1000); // console.log(expiresTime)\n              // Cookies.set('token', 'value', {\n              //     expires: expiresTime,\n              // });\n              // document.cookie = \"token=\"+  data.token + \";expires=\" + expiresTime.toGMTString();\n\n              localStorage.setItem('token', data.token); // localStorage.setItem('tokendate',expiresTime)\n\n              console.log(data);\n              sessionStorage.setItem('token', data.admin.token);\n              sessionStorage.setItem('roleId', data.admin.roleId);\n              sessionStorage.setItem('uid', data.admin.uid); // localStorage.setItem('rid', data.tid)\n              // localStorage.setItem('username', formLogin.username)\n\n              _this.$message({\n                type: 'success',\n                message: '登陆成功！'\n              }); // 改变登录状态为已登录\n\n\n              _this.$store.commit('moduleLogin/login'); // 跳转到应用\n\n\n              _this.$router.push('/');\n            } else {\n              _this.$message({\n                type: 'error',\n                message: message\n              });\n            }\n          });\n        }\n      });\n    },\n    getcode: function getcode() {\n      var _this2 = this;\n\n      var that = this;\n\n      if (!this.timer) {\n        if (!/^1[3456789]\\d{9}$/.test(this.formLogin.phone)) {\n          this.$message({\n            type: 'error',\n            message: '请输入正确的手机号码'\n          });\n          return false;\n        } else {\n          var pushdata = {\n            phone: this.formLogin.phone\n          };\n          var TIME_COUNT = 60;\n\n          if (!this.time) {\n            this.count = TIME_COUNT;\n            this.timer = setInterval(function () {\n              if (_this2.count > 0 && _this2.count <= TIME_COUNT) {\n                _this2.count--;\n              } else {\n                _this2.show = true;\n                clearInterval(_this2.timer);\n                _this2.timer = null;\n              }\n            }, 1000);\n          }\n\n          getCodeAPI(pushdata).then(function (res) {\n            var response = res.data;\n\n            if (response.code == 200) {\n              _this2.$message({\n                type: 'success',\n                message: '获取验证码成功'\n              });\n            }\n          }).catch(function (err) {\n            console.log(err);\n            _this2.tableLoading = false;\n          });\n        }\n      }\n    },\n    errorMsg: function errorMsg(message) {\n      this.$message({\n        message: message,\n        type: 'error',\n        duration: 1500\n      });\n    }\n  },\n  mounted: function mounted() {}\n};",null]}